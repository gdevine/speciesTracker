<% provide(:title, 'Sites') %>
<% provide(:pageheading, 'Available Sites') %>

<% if @sites.any? %>

	<div class="row topspace20">  
	  <div class="col-xs-12 col-sm-2 col-sm-push-10">
      <%= link_to "View List Mode", sites_path, :class => "btn btn-block btn-default" %>
		</div>
	</div>

	<div class="row topspace20">
	  <div class="col-md-12">	
		  <!-- Add map view of site -->
		  <div class='topspace20 bottomspace', 'width: 100%;'>
			  <div id="map" style='width: 100%; height: 400px;'></div>
			</div>
	  </div>
	</div>
	
<% else %>
  <p>No Sites found</p>
<% end %>

<script type="text/javascript">
handler = Gmaps.build('Google');
handler.buildMap({ 
	  provider: {
    }, 
    internal: {
  	  id: 'map'
    }
  }, 
  function(){
  markers = handler.addMarkers(<%=raw @hash.to_json %>);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
  handler.map.centerOn(markers[0]);
  handler.getMap().setZoom(9);
});
</script>