<% provide(:title, 'Edit Sighting') %>
<% provide(:pageheading, 'Edit Sighting '+@sighting.id.to_s) %>

<%= form_for @sighting, :html => {:class => "form-horizontal"} do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  
  <div class="form-group topspace50">
    <%= f.label :species_id, 'Species *', :class => "col-sm-2 col-sm-offset-1 control-label" %>
    <div class="col-lg-6">
      <%= collection_select(:sighting, :species_id, Species.all, :id, :fullname, {include_blank: 'None selected'}, {:class=>"form-control", :id=>'species'} ) %>
    </div>
  </div>
  
  <div class="form-group">
    <%= f.label :datetime_sighted, 'Date/Time of Sighting *', :class => "col-sm-2 col-sm-offset-1 control-label" %>
    <div class="col-lg-6">
      <%= f.datetime_local_field :datetime_sighted, :class => "form-control" %>
    </div>
  </div>
	  
	<% if current_user.role != 'user' %>
	  <div class="form-group">
	    <%= f.label :spotter_id, 'Sighted by *', :class => "col-sm-2 col-sm-offset-1 control-label" %>
	    <div class="col-lg-6">
	      <%= collection_select(:sighting, :spotter_id, User.all, :id, :fullname, {}, {:class=>"form-control", :id=>'spotters'} ) %>
	    </div>
	  </div>
	<% end %>
  
  <div class="form-group">
    <%= f.label :site_id, 'Site *', :class => "col-sm-2 col-sm-offset-1 control-label" %>
    <div class="col-lg-6">
      <%= collection_select(:sighting, :site_id, Site.all, :id, :name, {include_blank: 'None selected'}, {:class=>"form-control", :id=>'sites'} ) %>
    </div>
  </div>  
  
  <div class="row topspace20 bottomspace">
	  <div class="col-md-2 col-md-offset-3">
		  <button class="btn btn-block btn-default" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
		    <% if !@sighting.latitude.nil? %>
		      Edit Specific Location
		    <% else %>  
		      Add Specific Location
	      <% end %>
		  </button>
		</div>  
	</div>
  
  
  <div class="form-group">
  	<% if !@sighting.latitude.nil? %>
		  <div class="collapse in col-md-6 col-md-offset-3" id="collapseExample">
		<% else %>  
		  <div class="collapse col-md-6 col-md-offset-3" id="collapseExample">
	  <% end %>		
			<div class="well">
			  <div class="form-group">
			    <%= f.label :latitude, "Latitude", :class => "col-lg-4 control-label" %>
			    <div class="col-lg-6">
			      <%= f.number_field :latitude, :class => "form-control", :min => -90.0, :max => 90.0, :step => 'any' %>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <%= f.label :longitude, "Longitude", :class => "col-lg-4 control-label" %>
			    <div class="col-lg-6">
			      <%= f.number_field :longitude, :class => "form-control", :min => 0.0, :max => 360.0, :step => 'any' %>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <%= f.label :altitude, "Altitude (m)", :class => "col-lg-4 control-label" %>
			    <div class="col-lg-6">
			      <%= f.number_field :altitude, :class => "form-control", :min => 0.0, :max => 10000.0, :step => 'any' %>
			    </div>
			  </div>
			</div>
	  </div>
	</div>
    
  <div class="form-group">
    <%= f.label :comments, "Comments", :class => "col-sm-2 col-sm-offset-1 control-label" %>
    <div class="col-lg-6">
      <%= f.text_area :comments, :class => "form-control" %>
    </div>
  </div>
    
  <div class="form-group">
    <%= f.label :photo, "Photograph", :class => "col-sm-2 col-sm-offset-1 control-label" %>
    <div class="col-lg-6">
			<div class="fileinput fileinput-exists" data-provides="fileinput">
			  <div class="fileinput-preview thumbnail" data-trigger="fileinput" style="width: 25%; height: 100%;">
			  	<%= image_tag(@sighting.photo.url(:thumb), class:"img-thumbnail") %>
			  </div>
			  <div>
			    <span class="btn btn-default btn-file">
			      <span class="fileinput-exists">Change Photo</span>
					  <%= f.file_field :photo, :class => "form-control" %>
			    </span>
			  </div>
			</div>
		</div>
  </div>
  
  <div class="form-group">
    <div class="col-md-4 col-md-offset-4 topspace50 bottomspace">
      <%= f.submit "Update", :class => "btn btn-large btn-primary" %>
    </div>
  </div>
  
<% end %>


<script type="text/javascript">
$('#species, #sites, #spotters').multiselect({
    buttonClass : "form-control",
    buttonWidth: "100%",
    maxHeight: 400,
    enableCaseInsensitiveFiltering: true,
});
</script>